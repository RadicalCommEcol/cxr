% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/er_optim.R
\name{er_optim}
\alias{er_optim}
\title{Estimate competition effects and responses for a set of species}
\usage{
er_optim(lambda.vector, e.vector, r.vector, lambda.cov = NULL,
  e.cov = NULL, r.cov = NULL, sigma, lower.lambda = 0,
  upper.lambda = 1000, lower.e, upper.e, lower.r, upper.r,
  lower.lambda.cov = NULL, upper.lambda.cov = NULL,
  lower.e.cov = NULL, upper.e.cov = NULL, lower.r.cov = NULL,
  upper.r.cov = NULL, lower.sigma, upper.sigma, effect.response.model,
  optim.method, sp.data, covariates = NULL, optimize.lambda = FALSE,
  generate.errors = FALSE, bootstrap.samples = 0)
}
\arguments{
\item{lambda.vector}{1d vector of lambda estimates/initial values (depending on whether lambda values are optimized or not)}

\item{e.vector}{1d vector of competitive effect initial values}

\item{r.vector}{1d vector of competitive response initial values}

\item{lambda.cov}{numeric matrix of num.sp x num.covariates, effect of every covariate on species' lambda. 
Discarded if covariates are not passed.}

\item{e.cov}{numeric matrix of num.sp x num.covariates, effect of every covariate on species' competitive effect.
Discarded if covariates are not passed.}

\item{r.cov}{numeric matrix of num.sp x num.covariates, effect of every covariate on species' competitive response. 
Discarded if covariates are not passed.}

\item{sigma}{initial value for variation estimate.}

\item{lower.lambda}{lower bound for lambda, in case it is optimized. Either length 1 or same length as lambda.vector}

\item{upper.lambda}{upper bound for lambda, in case it is optimized. Either length 1 or same length as lambda.vector}

\item{lower.e}{lower bound for competitive effects. Either length 1 or same length as e.vector}

\item{upper.e}{upper bound for competitive effects. Either length 1 or same length as e.vector}

\item{lower.r}{lower bound for competitive responses. Either length 1 or same length as r.vector}

\item{upper.r}{upper bound for competitive responses. Either length 1 or same length as r.vector}

\item{lower.lambda.cov}{lower bound for covariate effects on lambda. Either length 1 or same length as lambda.cov. 
Discarded if covariates are not passed.}

\item{upper.lambda.cov}{upper bound for covariate effects on lambda. Either length 1 or same length as lambda.cov. 
Discarded if covariates are not passed.}

\item{lower.e.cov}{lower bound for covariate effects on e. Either length 1 or same length as e.cov. 
Discarded if covariates are not passed.}

\item{upper.e.cov}{upper bound for covariate effects on e. Either length 1 or same length as e.cov. 
Discarded if covariates are not passed.}

\item{lower.r.cov}{lower bound for covariate effects on r. Either length 1 or same length as r.cov. 
Discarded if covariates are not passed.}

\item{upper.r.cov}{upper bound for covariate effects on r. Either length 1 or same length as r.cov. 
Discarded if covariates are not passed.}

\item{lower.sigma}{lower bound for sigma. Length 1.}

\item{upper.sigma}{upper bound for sigma. Length 1.}

\item{effect.response.model}{function returning a value to optimize over, e.g. maximum likelihood}

\item{optim.method}{optimization method to use. One of the following: "optim_NM","optim_L-BFGS-B","nloptr_CRS2_LM", 
"nloptr_ISRES","nloptr_DIRECT_L_RAND","GenSA","hydroPSO","DEoptimR".}

\item{sp.data}{dataframe with all the necessary information in long format. It should have the following columns:
- site: character ID
- focal: character ID of the focal species. Any number of focal species is allowed, but the number of focal species
must match the number of initial parameters (one lambda, e, and r per species).
- fitness: numeric, a fitness metric
- competitor: character, ID of a competitor for that observation. The set of competitors must be, for now, the same
as the set of focal species.
- number: number of neighbouring/competitor individuals from the associated species. Observations without competitors of a given species
must be explicit, i.e. setting number to zero.}

\item{covariates}{optional matrix/dataframe with as many rows as the sp.data dataframe, and covariates in columns.}

\item{optimize.lambda}{boolean, whether we want to optimize lambda values or not.}

\item{generate.errors}{boolean, whether to compute bootstrap errors for the fitted parameters. Note that, depending on 
the data and optimization method, this may be computationally expensive.}

\item{bootstrap.samples}{how many bootstrap samples to compute.}
}
\value{
list with estimated species values for e, r, lambda (optional), and if covariates are given, the effects of covariates on lambda, r, and e.
}
\description{
This function is similar in spirit to pm_optim, in that it optimizes a set of parameters
via maximum likelihood. See vignette 'Obtain competitive responses and effects' for an example of its use.
}
